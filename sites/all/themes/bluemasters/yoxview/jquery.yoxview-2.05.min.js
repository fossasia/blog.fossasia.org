var yoxviewApi;
(function(w){var E;w.yoxviewUnload=function(){if(yoxviewApi){yoxviewApi.unload();yoxviewApi=null}};w(window).unload(function(){w.yoxviewUnload()});w.fn.extend({yoxview:function($){if(this.length==0)return this;var V=this;E||(E=typeof _yoxviewPath!="undefined"?_yoxviewPath:Yox.getPath(/(.*)jquery.yoxview.*/i));this.loadSkin=function(r,F){var v=r.skin;if(!yoxviewSkins[v]){var G=E+"skins/"+v+"/yoxview."+v;w.ajax({url:G+".js",dataType:"script",success:function(oa){eval(oa);w.extend(r,yoxviewSkins[v].options);yoxviewSkins[v].css!==
false&&Yox.addStylesheet(parent.document,G+".css");V.loadLanguage(r,F)},error:function(){alert("Error loading skin file "+G+".js")}})}};this.loadLanguage=function(r,F){var v=r.lang;if(yoxviewLanguages[v])Yox.loadDataSource(r,F,V);else{yoxviewLanguages[v]={};w.ajax({url:E+"lang/"+v+".js",async:false,dataType:"json",success:function(G){yoxviewLanguages[v]=G;Yox.loadDataSource(r,F,V)}})}};var Ba={autoHideInfo:true,autoPlay:false,backgroundColor:"#000000",backgroundOpacity:0.8,buttonsFadeTime:300,cacheBuffer:5,
cacheImagesInBackground:true,controlsInitialFadeTime:1500,controlsInitialDisplayTime:1E3,dataFolder:E+"data/",defaultDimensions:{flash:{width:720,height:560},iframe:{width:1024}},flashVideoPlayer:"jwplayer",imagesFolder:E+"images/",infoBackColor:"#000000",infoBackOpacity:0.5,isRTL:false,lang:"en",langFolder:E+"lang/",loopPlay:true,parentElement:w(parent.document.body),playDelay:3E3,popupMargin:20,popupResizeTime:600,renderButtons:true,renderMenu:true,showBarsOnOpen:true,showButtonsOnOpen:true,titleAttribute:"title",
titleDisplayDuration:2E3},M=w.extend(true,Ba,$);(M.skin?this.loadSkin:this.loadLanguage).apply(this,[M,function(r){if(yoxviewApi)yoxviewApi.AddViews(r,M);else yoxviewApi=new YoxView(r,M)}]);return this}})})(jQuery);var yoxviewLanguages=[],yoxviewSkins=[];
function YoxView(w,E){function $(a){a=e(a).data("yoxview");if(!x||Ca!=a.viewIndex){x=a.images;l=x.length;Ca=a.viewIndex;pa=a.cachedImagesCount;N=a.cacheDirectionForward;O=a.cacheBufferLastIndex;var b=false;if(a.options&&!Yox.compare(c,a.options)){c=a.options;b=true}else if(!a.options&&!Yox.compare(c,Da)){c=Da;b=true}else if(W&&l==1||j&&!W&&l>0)b=true;if(b){if(j){s.remove();P=X=aa=Q=qa=W=j=undefined;pa=ba=y=0;ca=false;g.infoButtons={}}Ea()}}}function V(a,b){var d=b.queryFields&&(b.queryFields.width||
b.queryFields.height)?{width:parseInt(b.queryFields.width),height:parseInt(b.queryFields.height)}:c.defaultDimensions[a];if(isNaN(d.width))d.width=null;if(isNaN(d.height))d.height=null;if(b.queryFields){b.queryFields.width=undefined;b.queryFields.height=undefined}return d}function Ba(a,b,d){a=e(a);a.data("yoxview",{viewIndex:b,cachedImagesCount:0,cacheDirectionForward:true,cacheBufferLastIndex:null});d.allowedImageUrls=[Yox.Regex.image];if(d.allowedUrls)d.allowedImageUrls=d.allowedImageUrls.concat(d.allowedUrls);
if(!Yox.compare(c,d))a.data("yoxview").options=d;d.isSingleLink=a[0].tagName=="A";var f=[],i=0;(d.isSingleLink?a:a.find("a:has(img)")).each(function(h,H){var q=e(H),m;m={};var K=q.attr("href"),R=q.children("img:first");m={};for(supportedType in Qa){var da=Qa[supportedType](q,K,R,d);if(da){e.extend(da,{contentType:supportedType,elementId:bb++});m.media=da;break}}if(m.media){m.thumbnailImg=R;m=m}else m=null;if(m!=null){f.push(m);if(d.isSingleLink)q.data("yoxview").imageIndex=i;else q.data("yoxview",
{imageIndex:i});i++}});if(d.images)f=f.concat(d.images);if(d.dataSource)Yox.dataSources[d.dataSource].getImagesData(d,function(h){f=f.concat(h.images);a.data("yoxview").images=f;var H=h.isGroup?[e.extend(h,{media:{title:h.title+" ("+h.images.length+" images)",alt:h.title}})]:h.images;M(a,d.isSingleLink?null:H,!h.createGroups?null:function(q){var m=e(q.currentTarget).data("yoxview"),K=e(q.currentTarget);q=K.data("yoxthumbs");if(m.imagesAreSet)g.openGallery(m.viewIndex);else{K.css("cursor","wait");
var R=e.extend({},c);if(R.dataSourceOptions)e.extend(R.dataSourceOptions,q);else R.dataSourceOptions=q;Yox.dataSources[c.dataSource].getImagesData(R,function(da){m.images=da.images;m.imagesAreSet=true;K.css("cursor","");g.openGallery(m.viewIndex)})}});h.createGroups?e.each(a.yoxthumbs("thumbnails"),function(q,m){m.data("yoxview",{viewIndex:S.length});S.push(m)}):e.each(a.yoxthumbs("thumbnails"),function(q,m){var K=i+q;f[K].thumbnailImg=m.children("img").eq(0);m.data("yoxview",{imageIndex:K})});if(!g.firstViewWithImages&&
h.images.length>0){g.firstViewWithImages=a;d.cacheImagesInBackground&&g.startCache()}});else{a.data("yoxview").images=f;M(a)}}function M(a,b,d){var f=function(i){var h=e(i.currentTarget).data("yoxview");if(!h||h.imageIndex===null)return true;else{i.preventDefault();g.openGallery(e(i.liveFired||i.currentTarget).data("yoxview").viewIndex,h.imageIndex)}};if(a[0].tagName=="A")a.bind("click.yoxview",f);else b?a.yoxthumbs({images:b,enableOnlyMedia:false,onClick:d||function(i){i.preventDefault();c.thumbnailsOptions&&
c.thumbnailsOptions.onClick?c.thumbnailsOptions.onClick(e(i.currentTarget).data("yoxview").imageIndex,e(i.currentTarget),e(i.liveFired).data("yoxview").viewIndex):g.openGallery(e(i.liveFired||i.currentTarget).data("yoxview").viewIndex,e(i.currentTarget).data("yoxview").imageIndex);return false}}):a.delegate("a:has(img)","click.yoxview",f)}function r(a){var b=e(S[Ca]);B=b[0].tagName=="A"?b:x[y].thumbnailImg;if(!B||B.length==0)B=x[0].thumbnailImg;if(B){a&&Q&&Q.attr("src",B.attr("src"));Fa=B.offset();
t={width:B.width(),height:B.height(),top:Fa.top-e(window).scrollTop(),left:Fa.left}}}function F(a){ra.css("background-position",I.getBackgroundPosition("notifications",a));ra.stop().fadeIn(c.buttonsFadeTime,function(){e(this).delay(500).fadeOut(c.buttonsFadeTime)})}function v(a){e(a).stop().animate({opacity:0.5},c.buttonsFadeTime)}function G(a,b,d){var f=e("<a>",{href:"#",click:function(){return g.clickBtn(g[b],d)}});e("<span>"+a+"</span>").css("opacity","0").appendTo(f);f.append(I.getSprite("icons",
b));return f}function oa(a,b,d){var f=new Image;f.src=c.imagesFolder+b+".png";f=e("<a>",{css:{background:"url("+f.src+") no-repeat "+b+" center",opacity:"0",outline:"0"},className:"yoxview_ctlBtn",href:"#"});f.css(b,"0");if(d)f.css("cursor","default");else{f.click(function(){this.blur();return g.clickBtn(a,true)});c.buttonsFadeTime!=0&&f.hover(function(){g.isOpen&&e(this).stop().animate({opacity:0.6},c.buttonsFadeTime)},function(){e(this).stop().animate({opacity:0},c.buttonsFadeTime)})}return f}function cb(){var a=
typeof c.popupMargin=="number"?[String(c.popupMargin)]:c.popupMargin.split(" ",4);k.top=parseInt(a[0]);if(a.length==1)k.bottom=k.right=k.left=k.top;else if(a.length==2){k.bottom=k.top;k.right=k.left=parseInt(a[1])}else if(a.length==3){k.bottom=parseInt(a[2]);k.right=k.left=parseInt(a[1])}else if(a.length==4){k.right=parseInt(a[1]);k.bottom=parseInt(a[2]);k.left=parseInt(a[3])}k.totalHeight=k.top+k.bottom;k.totalWidth=k.left+k.right}function Ea(){cb();C=Ra();n=yoxviewLanguages[c.lang];var a=c.skin?
yoxviewSkins[c.skin]:null;j=e("<div>",{id:"yoxview",click:function(h){h.stopPropagation()}});s=e("<div>",{id:"yoxview_popupWrap",click:function(h){h.preventDefault();g.clickBtn(g.close,true)}});c.skin&&s.attr("className","yoxview_"+c.skin);if(c.backgroundOpacity===0)s.css("background","none");else Yox.Support.rgba()&&s.css("background-color",Yox.hex2rgba(c.backgroundColor,c.backgroundOpacity));s.appendTo(c.parentElement).append(j);X=e("<div>",{className:"yoxview_imgPanel",css:{"z-index":"2"}});P=
e("<div>",{className:"yoxview_imgPanel",css:{"z-index":"1",display:"none"}});Q=e("<img />",{className:"yoxview_fadeImg",css:{display:"block",width:"100%",height:"100%"}});aa=e("<img />",{className:"yoxview_fadeImg",css:{display:"block",width:"100%",height:"100%"}});X.data("yoxviewPanel",{image:Q}).append(Q).appendTo(j);P.data("yoxviewPanel",{image:aa});P.append(aa).appendTo(j);var b=l==1;if(b&&!x[0].media.title)c.renderInfo=false;if(c.renderMenu!==false){var d=e("<div>",{className:"yoxview_popupBarPanel yoxview_top"});
c.autoHideMenu!==false&&d.hover(function(){g.isOpen&&Sa()},function(){g.isOpen&&Ga()});z=e("<div>",{id:"yoxview_menuPanel"});if(Yox.Support.rgba()&&c.menuBackgroundColor)z.css("background",Yox.hex2rgba(c.menuBackgroundColor,c.menuBackgroundOpacity||0.8));var f=G(n.Help,"help",false);g.infoButtons.playBtn=G(n.Slideshow,"play",false);ea=g.infoButtons.playBtn.children("span");z.append(G(n.Close,"close",true),f,g.infoButtons.playBtn);if(b){g.infoButtons.playBtn.css("display","none");f.css("display","none");
z.css({width:58})}z.find("a:last-child").attr("class","last");d.append(z).appendTo(j);z.delegate("a","mouseenter",function(){e(this).stop().animate({top:"8px"},"fast").find("span").stop().animate({opacity:1},"fast")}).delegate("a","mouseleave",function(){e(this).stop().animate({top:"0"},"fast").find("span").stop().animate({opacity:0},"fast")})}if(c.renderButtons!==false&&(!b||!e.support.opacity)){W=oa(g.prev,c.isRTL?"right":"left",b);qa=oa(g.next,c.isRTL?"left":"right",b);j.append(W,qa);T=b&&!e.support.opacity?
e():j.find(".yoxview_ctlBtn")}else T=e();fa=e("<div>",{id:"yoxview_ajaxLoader",className:"yoxview_notification",css:{display:"none"}});fa.append(e("<img>",{src:c.imagesFolder+"popup_ajax_loader.gif",alt:n.Loading,css:{width:32,height:32,"background-image":"url("+c.imagesFolder+"sprites.png)","background-position":I.getBackgroundPosition("notifications","empty")}})).appendTo(j);if(!c.disableNotifications){ra=e("<img>",{className:"yoxview_notification"});j.append(ra)}U=e("<div>",{id:"yoxview_helpPanel",
href:"#",title:n.CloseHelp,css:{background:"url("+c.imagesFolder+"help_panel.png) no-repeat center top",direction:n.Direction,opacity:"0"},click:function(){return g.clickBtn(g.help,false)}});d=document.createElement("h1");d.innerHTML=n.Help.toUpperCase();f=document.createElement("p");f.innerHTML=n.HelpText;var i=document.createElement("span");i.id="yoxview_closeHelp";i.innerHTML=n.CloseHelp;U.append(d).append(f).append(i).appendTo(j);if(c.renderInfo!==false){o=e("<div>",{id:"yoxview_infoPanel",click:function(h){h.stopPropagation()}});
if(c.infoBackOpacity===0){o.css("background","none");J=o}else if(Yox.Support.rgba()){J=o;o.css("background-color",Yox.hex2rgba(c.infoBackColor,c.infoBackOpacity))}else{o.append(e("<div>",{id:"yoxview_infoPanelBack",css:{background:c.infoBackColor,opacity:c.infoBackOpacity}}));J=e("<div>",{id:"yoxview_infoPanelContent"})}sa=e("<span>",{id:"yoxview_count"});Y=e("<div>",{id:"yoxview_infoText"});if(b){Y.css("margin-left","10px");sa.css("display","none")}J.append(sa);if(c.renderInfoPin!==false){Ha=I.getSprite("icons",
c.autoHideInfo?"pin":"unpin");Ta=e("<a>",{className:"yoxviewInfoLink",href:"#",title:c.autoHideInfo?n.PinInfo:n.UnpinInfo,css:{display:"inline"},click:function(h){h.preventDefault();c.autoHideInfo=!c.autoHideInfo;Ha.css("background-position",I.getBackgroundPosition("icons",c.autoHideInfo?"pin":"unpin"));this.title=c.autoHideInfo?n.PinInfo:n.UnpinInfo}});Ta.append(Ha).appendTo(J)}if(a&&a.infoButtons){a=a.infoButtons(c,n,I,s,j);if(c.infoButtons)e.extend(c.infoButtons,a);else c.infoButtons=a}if(c.infoButtons){e.extend(g.infoButtons,
c.infoButtons);for(infoButton in c.infoButtons)c.infoButtons[infoButton].attr("className","yoxviewInfoLink").css("display","block").appendTo(J)}if(c.linkToOriginalContext!==false){ga=e("<a>",{className:"yoxviewInfoLink",target:"_blank",title:n.OriginalContext});ga.append(I.getSprite("icons","link")).appendTo(J)}J.append(Y);Yox.Support.rgba()||o.append(J);o.appendTo(c.renderInfoExternally?s:j);if(!c.renderInfoExternally){L=e("<div>",{className:"yoxview_popupBarPanel yoxview_bottom"});L.hover(function(){g.isOpen&&
!ha&&c.autoHideInfo!==false&&ta()},function(){g.isOpen&&!ha&&c.autoHideInfo!==false&&ia()});o.wrap(L);L=o.parent()}}Yox.Support.rgba()||(db=e("<div>",{css:{position:"fixed",height:"100%",width:"100%",top:"0",left:"0",background:c.backgroundColor,"z-index":"1",opacity:c.backgroundOpacity}}).appendTo(s))}function Ia(){pa++;if(pa==l)ca=true;ca||Ua()}function Ua(){if(!c.cacheBuffer||ba!=O)ja(ba+(N?1:-1))}function Ja(){if(c.cacheBuffer){O=N?y+c.cacheBuffer:y-c.cacheBuffer;if(O<0)O+=l;else if(O>=l)O-=l}}
function ja(a){if(!ca){if(a==l)a=0;else if(a<0)a+=l;var b=x[a].media;ba=a;if(b&&!b.loaded)if(b.contentType==="image"||!b.contentType)Va.src=b.src;else Wa(b,function(){Ia()});else Ua()}}function Xa(){Ka=true;clearTimeout(La);fa.stop();La=setTimeout(function(){fa.css("opacity","0.6").fadeIn(c.buttonsFadeTime)},c.buttonsFadeTime)}function Ma(a,b,d,f,i){j.stop().animate({width:a,height:b,top:d,left:f},c.popupResizeTime,i)}function ua(){if(l!=1){p=true;if(ea)ea.text(n.Pause);else g.infoButtons.playBtn&&
g.infoButtons.playBtn.attr("title",n.Pause);g.infoButtons.playBtn&&g.infoButtons.playBtn.find("img").css("background-position",I.getBackgroundPosition("icons","pause"));if(y<l-1)Na=setTimeout(function(){g.next(true)},c.playDelay);else if(c.loopPlay)Na=setTimeout(function(){g.select(0,null)},c.playDelay);else D()}}function D(){clearTimeout(Na);p=false;if(ea)ea.text(n.Play);else g.infoButtons.playBtn&&g.infoButtons.playBtn.attr("title",n.Play);g.infoButtons.playBtn&&g.infoButtons.playBtn.find("img").css("background-position",
I.getBackgroundPosition("icons","play"))}function Ra(){var a=e(parent.window).width(),b=e(parent.window).height();return{height:b,width:a,usableHeight:b-k.totalHeight,usableWidth:a-k.totalWidth}}function Ya(a){a=a.width&&a.height?Yox.fitImageSize(a,{width:C.usableWidth,height:C.usableHeight}):{width:a.width?Math.min(a.width,C.usableWidth):C.usableWidth,height:a.height?Math.min(a.height,C.usableHeight):C.usableHeight};a.top=k.top+Math.round((C.usableHeight-a.height)/2);a.left=k.left+Math.round((C.usableWidth-
a.width)/2);return a}function ta(a){clearTimeout(ka);var b=Y.outerHeight();if(b<Za)b=Za;o.stop().animate({height:b},500,function(){a&&a()})}function ia(a){clearTimeout(ka);o.stop().animate({height:0},500,function(){a&&a()})}function Ga(a){if(z){clearTimeout(Oa);z.stop().animate({top:eb},500,function(){a&&a()})}}function Sa(a){if(z){clearTimeout(Oa);z.stop().animate({top:0},500,function(){a&&a()})}}function $a(){la=u;u=va?P:X;va=!va}function wa(a){var b=a.contentType==="image"||!a.contentType;b&&ha&&
L&&L.css("display","block");clearTimeout(ka);$a();var d=u.data("yoxviewPanel");A.width=a.width;A.height=a.height;A.padding=a.padding;if(o){var f=a.title||"";if(a.description)f+=f!=""?"<div id='yoxview_infoTextDescription'>"+a.description+"</div>":a.description;Y.html(f);l>1&&sa.html(y+1+"/"+l);if(ga)g.currentImage.link?ga.attr("href",g.currentImage.link).css("display","inline"):ga.css("display","none")}f=Ya(a);if(b){currentImageElement=va?Q:aa;currentImageElement.attr({src:a.src,title:a.title,alt:a.alt});
d.image=currentImageElement;if(!d.isImage&&d.element){d.element.css("display","none");d.image.css("display","block");d.isImage=true}if(!ma){c.renderButtons&&T.css({height:"100%",width:"50%",top:"0"});ha=false;ma=true}}else{if(d.element&&d.elementId!=a.elementId){d.element.remove();d.element=undefined}if(!d.element)if(a.html){d.element=e("<div>",{className:fb});j.append(d.element)}else{j.append(a.element);d.element=a.element}a.html&&d.element.html(a.html);u=d.element;if(ma){if(L){c.autoHideInfo!==
false&&ia();L.css("display","none");ha=true}c.renderButtons&&T.css({width:xa.width,height:xa.height});ma=false}c.renderButtons&&T.css({top:(f.height-xa.height)/2});if(d.isImage===undefined||d.isImage){d.element.css("display","block");d.image.css("display","none");d.isImage=false}}ya?u.animate({width:f.width,height:f.height},c.popupResizeTime):u.css({width:f.width,height:f.height});if(Ka){Ka=false;clearTimeout(La);fa.stop().fadeOut(c.buttonsFadeTime)}Z=true;Ma(f.width,f.height,f.top,f.left,function(){if(ya){g.isOpen=
true;if(c.controlsInitialDisplayTime>0){c.showButtonsOnOpen&&T.animate({opacity:0.5},c.controlsInitialFadeTime,function(){c.buttonsFadeTime!=0&&e(this).delay(c.controlsInitialDisplayTime).animate({opacity:0},c.controlsInitialFadeTime)});if(c.showBarsOnOpen){Sa(function(){if(c.autoHideMenu!==false)Oa=setTimeout(function(){Ga()},c.controlsInitialDisplayTime)});o&&ta(function(){if(c.autoHideInfo!==false)ka=setTimeout(function(){ia()},c.controlsInitialDisplayTime)})}}c.autoPlay&&g.play();c.onOpen&&c.onOpen();
if(za){za();za=undefined}ya=false}if(A.padding){var i=j.width(),h=j.height();if(A.padding){i-=A.padding.horizontal;h-=A.padding.vertical}u.css({width:i+"px",height:h+"px"})}Z=false});u.css({"z-index":"2",opacity:1});la&&la.css("z-index","1");u.fadeIn(c.popupResizeTime,function(){la&&la.css("display","none");o&&ta(function(){if(c.autoHideInfo!==false)ka=setTimeout(function(){ia()},c.titleDisplayDuration)});if(l>1){if(c.cacheImagesInBackground&&!ca)ja(y+(N?1:-1));p&&ua()}})}function gb(a,b,d,f,i){jQuery.jsonp({url:hb[a]||
"http://oohembed.com/oohembed/",data:jQuery.extend({url:b,format:"json"},d),dataType:"jsonp",callbackParameter:"callback",success:function(h){var H={title:h.title,width:h.width,height:h.height,type:h.type};if(h.type==="video")H.html=h.html.replace(/<embed /,'<embed wmode="transparent" ').replace(/<param/,'<param name="wmode" value="transparent"><param').replace(/width=\"[\d]+\"/ig,'width="100%"').replace(/height=\"[\d]+\"/ig,'height="100%"');else h.type==="photo"&&jQuery.extend(H,{src:h.url,alt:h.title,
type:"image"});f(H)},error:function(h,H){i&&i(h,H)}})}function ab(a){try{if(!a)throw"Error: Media is unavailable.";if(a.contentType==="image"||!a.contentType){if(e.support.opacity)Pa.src="";Pa.src=a.src}else!a.loaded&&a.contentType=="ooembed"?Wa(a,function(d){wa(d)},function(d){Aa("Error getting data from:<br /><span class='errorUrl'>"+d.data.url+"</span>")}):wa(g.currentImage.media)}catch(b){Aa(b)}}function Wa(a,b,d){a.contentType=="ooembed"&&gb(a.provider,a.url,c.videoSize,function(f){e.extend(a,
f,{loaded:true});b&&b(a)},d)}function Aa(a){wa({html:"<span class='yoxview_error'>"+a+"</span>",width:500,height:300,type:"error",title:""})}var g=this,e=jQuery,fa,O,ca=false,pa=0,N=true,Va=new Image,sa,T,ba=0,bb=0,y=0,n={},A={},Ca=0,Da=E,ha=false,ib={wmode:"transparent",width:"100%",height:"100%",allowfullscreen:"true",allowscriptaccess:"true",hasVersion:9},ya=true,U,ka,Oa,Q,aa,x,l=0;this.infoButtons={};var o,J,ga,Za=30,L,Ta,Ha,Y,va=this.isOpen=false,ma=true,p=false,Z=false,La,Ka=false,xa={width:100,
height:100},fb="yoxview_mediaPanel",hb={vimeo:"http://vimeo.com/api/oembed.json",myspace:"http://vids.myspace.com/index.cfm?fuseaction=oembed"},eb=-42,z,qa,ra,za,c=Da,X,P,ea,j,db,k={},Na,s,W,na=false,Pa=new Image,B,Fa,t,S=[],C,jb={40:"DOWN",35:"END",13:"ENTER",36:"HOME",37:"LEFT",39:"RIGHT",32:"SPACE",38:"UP",72:"h",27:"ESCAPE"},kb={RIGHT:c.isRTL?"prev":"next",DOWN:"next",UP:"prev",LEFT:c.isRTL?"next":"prev",ENTER:"play",HOME:"first",END:"last",SPACE:"next",h:"help",ESCAPE:"close"},I=new Yox.Sprites({notifications:{width:59,
height:59,sprites:["empty","playRTL","play","pause","last","first"]},icons:{width:18,height:18,sprites:["close","help","playpause","link","pin","unpin","play","pause","right","left"]},menu:{height:42,sprites:["back"]}},c.imagesFolder+"sprites.png",c.imagesFolder+"empty.gif");this.AddViews=function(a,b){var d=this.firstViewWithImages!=undefined;jQuery.each(a,function(){Ba(this,S.length,b);S.push(this);if(!g.firstViewWithImages){var f=e(this).data("yoxview").images;if(f&&f.length!=0)g.firstViewWithImages=
this}});if(!d&&this.firstViewWithImages){$(this.firstViewWithImages);Ea();if(b.cacheImagesInBackground&&l!=0){Ja();ja(0)}d=true}};this.SetImages=function(a){l=a.length};var Qa={image:function(a,b,d,f){for(var i=null,h=0;h<f.allowedImageUrls.length&&!i;h++)if(b.match(f.allowedImageUrls[h]))i={src:a.attr("href"),title:d.attr(f.titleAttribute),alt:d.attr("alt")};return i},flash:function(a,b,d,f){var i=null;var h=(a=b.match(Yox.Regex.flash))?null:b.match(Yox.Regex.flashvideo);if(a||h){b=Yox.getUrlData(b);
i=e("<div>",{className:"yoxview_element",html:"<div class='yoxview_error'>Please install the latest version of the <a href='http://www.adobe.com/go/getflashplayer' target='_blank'>Flash player</a> to view content</div>"});h=h?Yox.flashVideoPlayers[f.flashVideoPlayer](f.flashVideoPlayerPath,b.path,b.queryFields&&b.queryFields.image?b.queryFields.image:d.attr("src"),d.attr(f.titleAttribute)):b.queryFields||{};if(a)h.swf=b.path;e.extend(h,ib);i.flash(h);i={element:i,title:d.attr(f.titleAttribute)};e.extend(i,
V("flash",b))}return i},ooembed:function(a,b){var d=null;for(videoProvider in Yox.Regex.video)if(b.match(Yox.Regex.video[videoProvider])){d={provider:videoProvider,url:b};break}return d},inline:function(a,b,d,f){if(!f.allowInternalLinks)return null;a=null;if((b=Yox.getUrlData(b))&&b.anchor){b=e("#"+b.anchor);if(b.length!=0){d={width:parseInt(b.css("width")),height:parseInt(b.css("height"))};b.css({position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"block"});a={type:"inlineElement",
element:b,title:b.attr("title")};f={horizontal:parseInt(b.css("padding-right"))+parseInt(b.css("padding-left")),vertical:parseInt(b.css("padding-top"))+parseInt(b.css("padding-bottom"))};d.width=isNaN(d.width)?null:d.width+f.horizontal;d.height=isNaN(d.height)?null:d.height+f.vertical;e.extend(a,d);if(f.horizontal!=0||f.vertical!=0)a.padding=f;b.remove()}}return a},iframe:function(a,b,d){var f=null;if((a=a.attr("target"))&&a=="yoxview")if((b=Yox.getUrlData(b))&&b.path){a=V("iframe",b);if(b.queryFields){b.queryFields.width=
undefined;b.queryFields.height=undefined}f={element:e("<iframe>",{src:Yox.urlDataToPath(b),className:"yoxview_element"}),title:d.attr("title"),frameborder:"0"};e.extend(f,a)}return f}};this.openGallery=function(a,b,d){if(typeof a=="function"){d=a;a=b=0}else if(typeof b=="function"){d=b;b=0}a=a||0;b=b||0;e(document).delegate("*","keydown.yoxview",function(f){if(g&&g.isOpen){var i=g[kb[jb[f.keyCode]]];if(i){f.preventDefault();i.apply(g)}}});$(S[a]);!j&&l!=0&&Ea();this.selectImage(b);s.stop().css({opacity:1}).fadeIn("slow",
function(){s.css("opacity","")});c.cacheImagesInBackground&&ja(b);if(d)za=d;return false};this.selectImage=function(a){g.currentImage=x[a];y=a;r(true);B.blur();X.css({"z-index":"1",width:t.width,height:t.height});P.css({display:"none","z-index":"2"});ya=true;j.css({width:t.width,height:t.height,top:t.top,left:t.left});this.select(a)};this.refresh=function(){(na=p)&&D();p||Xa();ab(g.currentImage.media);na&&ua()};this.select=function(a,b){if(typeof b==="number")b=undefined;if(!Z){if(a<0)a=l-1;else if(a==
l)a=0;if(!p&&b){var d=b;d.css("opacity")==0&&d.stop().animate({opacity:0},c.buttonsFadeTime,v(d))}g.currentImage=x[a];y=a;p||Xa();ab(g.currentImage.media);Ja();c.onSelect&&c.onSelect(a,x[a])}};this.prev=function(a){N=false;this.select(y-1,W);p&&a!==true&&D()};this.next=function(a){N=true;this.select(y+1,qa);p&&a!==true&&D()};this.first=function(){c.disableNotifications||F("first");this.select(0);p&&D()};this.last=function(){c.disableNotifications||F("last");this.select(l-1);p&&D()};this.play=function(){if(l!=
1){N=true;if(p){c.disableNotifications||F("pause");D()}else{c.disableNotifications||F("play");ua()}}};this.close=function(){this.closeHelp();r(false);Ma(t.width,t.height,t.top,t.left,function(){g.isOpen=false});Ga();o&&ia(function(){Y.html("")});u.animate({width:t.width,height:t.height},c.popupResizeTime,function(){u.css("opacity",1)});s.stop().fadeOut(1E3);p&&D();$a();c.onClose&&c.onClose();e(document).undelegate("*","keydown.yoxview");Z=false};this.help=function(){if(this.isOpen)U.css("display")==
"none"?U.css("display","block").stop().animate({opacity:0.8},c.buttonsFadeTime):this.closeHelp()};this.closeHelp=function(){U.css("display")!="none"&&U.stop().animate({opacity:0},c.buttonsFadeTime,function(){U.css("display","none")})};this.clickBtn=function(a,b){b&&p&&D();a.call(this);return false};this.AddViews(w,c);e(window).bind("resize.yoxview",function(){C=Ra();g.isOpen&&g.resize()});e(Va).load(function(){e.extend(x[ba].media,{width:this.width,height:this.height,loaded:true});Ia()}).error(function(){Ia()});
this.startCache=function(){$(this.firstViewWithImages);Ja();ja(0)};var u=P,la=X;this.resize=function(){if(p){na=true;D()}var a=Ya(A);u.css({width:"100%",height:"100%"});Z=true;ma||T.css({top:Math.round((a.height-xa.height)/2)});Ma(a.width,a.height,a.top,a.left,function(){var b=j.width(),d=j.height();if(A.padding){b-=A.padding.horizontal;d-=A.padding.vertical}u.css({width:b+"px",height:d+"px"});Z=false;o&&ta();if(na){ua();na=false}})};e(Pa).load(function(){this.width==0?Aa("Image error"):wa(e.extend({},
g.currentImage.media,{width:this.width,height:this.height}))}).error(function(){Aa("Image not found:<br /><span class='errorUrl'>"+this.src+"</span>")});this.unload=function(){jQuery.each(S,function(a,b){e(b).undelegate("a","click.yoxview").removeData("yoxview").yoxthumbs("unload","yoxview")});e(document).undelegate("*","keydown.yoxview");e(window).unbind(".yoxview");if(j){s.remove();j=undefined}}};
